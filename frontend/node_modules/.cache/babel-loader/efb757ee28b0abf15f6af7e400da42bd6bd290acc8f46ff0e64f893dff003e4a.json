{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RegisterForm=()=>{const[form,setForm]=useState({name:\"\",birth:\"\",gender:\"\",address:\"\",email:\"\",idImage:null,agreed:false,userId:\"\"});const[liffInitialized,setLiffInitialized]=useState(false);const[loading,setLoading]=useState(true);useEffect(()=>{const initLiff=async()=>{try{await window.liff.init({liffId:\"2007116087-jvyN7W7l\"});//ログインしてなければリダイレクトして止める\nif(!window.liff.isLoggedIn()){window.liff.login();return;}//ログイン済ならプロフィール取得\nconst profile=await window.liff.getProfile();setForm(prev=>({...prev,userId:profile.userId}));setLoading(false);}catch(error){console.error('LIFF初期化エラー',JSON.stringify(error,null,2));alert(\"LINE連携に失敗しました。再読み込みしてください。\");}};initLiff();},[]);const handleChange=e=>{const{name,value,type,checked,files}=e.target;setForm(prev=>({...prev,[name]:type===\"checkbox\"?checked:type===\"file\"?files[0]:value}));};const handleSubmit=async e=>{e.preventDefault();const formData=new FormData();formData.append('name',form.name);formData.append('birth',form.birth);formData.append('gender',form.gender);formData.append('address',form.address);formData.append('email',form.email);formData.append('userId',form.userId);formData.append('idImage',form.idImage);formData.append('agreed',form.agreed);try{const res=await fetch('https://line-reserve-system.onrender.com/api/register',{method:'POST',body:formData});if(res.ok){alert('登録が完了しました！');}else{alert('登録に失敗しました。');}}catch(err){console.error(err);alert('エラーが発生しました。');}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 max-w-md mx-auto space-y-4 text-center\",children:/*#__PURE__*/_jsx(\"p\",{children:\"LINE\\u9023\\u643A\\u4E2D\\u3067\\u3059\\u3002\\u5C11\\u3005\\u304A\\u5F85\\u3061\\u304F\\u3060\\u3055\\u3044...\"})});}return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"p-4 max-w-md mx-auto space-y-4 border rounded shadow\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold\",children:\"\\u500B\\u4EBA\\u60C5\\u5831\\u767B\\u9332\\u30D5\\u30A9\\u30FC\\u30E0\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u540D\\u524D\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:form.name,onChange:handleChange,className:\"w-full border p-2\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u751F\\u5E74\\u6708\\u65E5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"birth\",value:form.birth,onChange:handleChange,className:\"w-full border p-2\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u6027\\u5225\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"gender\",value:form.gender,onChange:handleChange,className:\"w-full border p-2\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9078\\u629E\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"}),/*#__PURE__*/_jsx(\"option\",{value:\"male\",children:\"\\u7537\\u6027\"}),/*#__PURE__*/_jsx(\"option\",{value:\"female\",children:\"\\u5973\\u6027\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"\\u305D\\u306E\\u4ED6\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u4F4F\\u6240\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"address\",value:form.address,onChange:handleChange,className:\"w-full border p-2\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u30E1\\u30FC\\u30EB\\u30A2\\u30C9\\u30EC\\u30B9\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:form.email,onChange:handleChange,className:\"w-full border p-2\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u8EAB\\u5206\\u8A3C\\u306E\\u753B\\u50CF\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"idImage\",onChange:handleChange,className:\"w-full\",accept:\"image/*\",required:true})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border p-2 text-sm bg-gray-100\",children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u30D7\\u30E9\\u30A4\\u30D0\\u30B7\\u30FC\\u30DD\\u30EA\\u30B7\\u30FC\\u3092\\u3053\\u3053\\u306B\\u8868\\u793A\\u3057\\u307E\\u3059\\u3002\\u500B\\u4EBA\\u60C5\\u5831\\u306F\\u9069\\u5207\\u306B\\u7BA1\\u7406\\u3055\\u308C\\u307E\\u3059\\u3002\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"agreed\",checked:form.agreed,onChange:handleChange}),\"\\u540C\\u610F\\u3057\\u307E\\u3059\"]})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\",children:\"\\u767B\\u9332\\u3059\\u308B\"})]});};export default RegisterForm;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","RegisterForm","form","setForm","name","birth","gender","address","email","idImage","agreed","userId","liffInitialized","setLiffInitialized","loading","setLoading","initLiff","window","liff","init","liffId","isLoggedIn","login","profile","getProfile","prev","error","console","JSON","stringify","alert","handleChange","e","value","type","checked","files","target","handleSubmit","preventDefault","formData","FormData","append","res","fetch","method","body","ok","err","className","children","onSubmit","onChange","required","accept"],"sources":["C:/Users/yukim/line-reserve-frontend/src/components/RegisterForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\n\r\nconst RegisterForm = () => {\r\n  const [form, setForm] = useState({\r\n    name: \"\",\r\n    birth: \"\",\r\n    gender: \"\",\r\n    address: \"\",\r\n\temail: \"\",\r\n    idImage: null,\r\n    agreed: false,\r\n\tuserId: \"\",\r\n  });\r\n  \r\n  const [liffInitialized, setLiffInitialized] = useState(false);\r\n  \r\n  const [loading, setLoading] = useState(true);\r\n  \r\n  useEffect(() =>{\r\n\t  const initLiff = async() =>{\r\n\t\t  try{\r\n\t\t\t  await window.liff.init({ liffId:\"2007116087-jvyN7W7l\"});\r\n\t\t\t  \r\n\t\t\t  //ログインしてなければリダイレクトして止める\r\n\t\t\t  if(!window.liff.isLoggedIn()){\r\n\t\t\t\t  window.liff.login();\r\n\t\t\t\t  return;\r\n\t\t\t  }\r\n\t\t\t  \r\n\t\t\t  //ログイン済ならプロフィール取得\r\n\t\t\t  const profile = await window.liff.getProfile();\r\n\t\t\t  setForm(prev => ({ ...prev, userId: profile.userId }));\r\n\t\t\t  setLoading(false);\r\n\t\t\t  }\r\n\t\t\t  \r\n\t\t\t  catch (error){\r\n\t\t\t  console.error('LIFF初期化エラー',JSON.stringify(error, null, 2));\r\n\t\t\t  alert(\"LINE連携に失敗しました。再読み込みしてください。\");\r\n\t\t  }\r\n\t  };\r\n\t  \r\n\t  initLiff();\r\n  }, []);\r\n  \r\n  \r\n  const handleChange = (e) => {\r\n  const { name, value, type, checked, files } = e.target;\r\n  setForm((prev) => ({\r\n    ...prev,\r\n    [name]: type === \"checkbox\" ? checked : type === \"file\" ? files[0] : value,\r\n  }));\r\n};\r\n\r\n  \r\n  \r\n  const handleSubmit = async (e) =>{\r\n\t  e.preventDefault();\r\n\t  \r\n \r\n  const formData = new FormData();\r\n  formData.append('name', form.name);\r\n  formData.append('birth', form.birth);\r\n  formData.append('gender', form.gender);\r\n  formData.append('address', form.address);\r\n  formData.append('email', form.email);\r\n  formData.append('userId', form.userId);\r\n  formData.append('idImage', form.idImage);\r\n  formData.append('agreed', form.agreed);\r\n\r\n  try {\r\n    const res = await fetch('https://line-reserve-system.onrender.com/api/register', {\r\n      method: 'POST',\r\n      body: formData,\r\n    });\r\n\r\n    if (res.ok) {\r\n      alert('登録が完了しました！');\r\n    } else {\r\n      alert('登録に失敗しました。');\r\n    }\r\n  } catch (err) {\r\n    console.error(err);\r\n    alert('エラーが発生しました。');\r\n  }\r\n};\r\n\r\nif (loading) {\r\n  return (\r\n    <div className=\"p-4 max-w-md mx-auto space-y-4 text-center\">\r\n      <p>LINE連携中です。少々お待ちください...</p>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"p-4 max-w-md mx-auto space-y-4 border rounded shadow\">\r\n      <h2 className=\"text-xl font-bold\">個人情報登録フォーム</h2>\r\n\r\n      <div>\r\n        <label>名前</label>\r\n        <input type=\"text\" name=\"name\" value={form.name} onChange={handleChange} className=\"w-full border p-2\" required />\r\n      </div>\r\n\r\n      <div>\r\n        <label>生年月日</label>\r\n        <input type=\"date\" name=\"birth\" value={form.birth} onChange={handleChange} className=\"w-full border p-2\" required />\r\n      </div>\r\n\r\n      <div>\r\n        <label>性別</label>\r\n        <select name=\"gender\" value={form.gender} onChange={handleChange} className=\"w-full border p-2\" required>\r\n          <option value=\"\">選択してください</option>\r\n          <option value=\"male\">男性</option>\r\n          <option value=\"female\">女性</option>\r\n          <option value=\"other\">その他</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div>\r\n        <label>住所</label>\r\n        <input type=\"text\" name=\"address\" value={form.address} onChange={handleChange} className=\"w-full border p-2\" required />\r\n      </div>\r\n\t  \r\n\t  <div>\r\n\t\t<label>メールアドレス</label>\r\n\t\t<input\r\n\t\t\ttype=\"email\"\r\n\t\t\tname=\"email\"\r\n\t\t\tvalue={form.email}\r\n\t\t\tonChange={handleChange}\r\n\t\t\tclassName=\"w-full border p-2\"\r\n\t\t\trequired\r\n\t\t/>\r\n\t  </div>\r\n\r\n      <div>\r\n        <label>身分証の画像</label>\r\n        <input type=\"file\" name=\"idImage\" onChange={handleChange} className=\"w-full\" accept=\"image/*\" required />\r\n      </div>\r\n\r\n      <div className=\"border p-2 text-sm bg-gray-100\">\r\n        <p>プライバシーポリシーをここに表示します。個人情報は適切に管理されます。</p>\r\n      </div>\r\n\r\n      <div>\r\n        <label>\r\n          <input type=\"checkbox\" name=\"agreed\" checked={form.agreed} onChange={handleChange} />\r\n          同意します\r\n        </label>\r\n      </div>\r\n\r\n      <button type=\"submit\" className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\">\r\n        登録する\r\n      </button>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default RegisterForm;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}